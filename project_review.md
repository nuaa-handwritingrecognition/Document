# 基于手写识别的防偷窥登录认证系统的设计与实现

>本文档主要复盘整个项目开发流程以及在项目开发过程中遇到的困难

## 一、客户端

由于在本次项目中，我们定义的数据是指尖在屏幕上滑动时产生的横、纵坐标，压力值这样的一个三元组。而这三类数据的获取在Android中已有成熟的API，所以我们的工作并不复杂，即：

* 获取用户行为产生的三元组数据
* 将数据发送到服务器端
* 接收并显示服务器的算法执行结果

目前我们规定，用户在注册过程中需要做10次完整的“方”字书写，登录做一次“方”字书写。

在实际开发中我们遇到的问题有：

1. 由于许久不搞android开发， 之前踩的一些坑都忘了，后来写到[这篇博客](<https://blog.csdn.net/qq_35636581/article/details/89460374>)了。
2. 对于手写界面需要用户先点击，获取到该手写界面的对象之后，才能做「重置」操作，否则报空指针异常的错
3. 对安卓中大量用到的多线程不熟悉，回调函数的书写基本都是仿造前人的工作
4. 一开始我们拿到的是xp学长写好的代码，实现的过于冗余，在他的代码的基础上修改得十分辛苦，这种情况下，建议以后还是自己重写一遍比较合适。

## 二、服务器端

我们发现使用Flask这样一个轻量级的Web应用框架来搭建服务器能够方便的嵌入算法模型， 同时与客户端的交互代码上会写的十分干练。所以我们毫不犹豫选择了它，我们的工作包括如下：

* 接受客户端数据
* 备份数据、送进网络
* 算法模型识别
* 返回结果

算法层面，我们尝试的算法有：KNN,SVM,LSTM等

在实际开发中我们遇到的问题有：

1. 起初对于数据的定义以及C/S交互的时候接口划分不清楚，做了很多无效的工作。不过这个没辙，项目初期确实思路理不清楚。
2. 我们选择使用CSV来存储格式，按理说应该用数据库，但是考虑到本项目更多是偏实验性，数据量不是特别大，再加上目前的代码版本留有足够好的接口，之后确实需要的话，要扩展也很方便的。
3. 按理说选用其中的任意一种模型数据都应该归一化处理，但是发现用LSTM时归一化之后效果反而不理想，在归一化的执行层面，是否每次有新的数据进来都应该对全部数据做归一化？
4. 对算法模型解耦和的时候，一个人思路特别容易混乱，所以后面不得不找老朱一起做，两个人约时间不好约，所以造成开发效率还不错，但是工作量并不高的情况。这个主要还是我水平不够的原因，还需要多锻炼。
5. 对tensorflow不够熟悉，我记得有一次重构代码的时候，竟然把定义图这个步骤忘了，十分可笑。还有就是每一个矩阵操作都要上网查API，效率自然就很低下，但是tf的常用API实在是太多了。用tf跑模型的逻辑是先定义Graph，然后开启Session，用到`sess.run()`的时候，才是真正的把数据送进网络做训练，接着是把训练好的网络模型参数保存下来。做预测的时候，还是得先定义Graph，然后读取训练好的权值文件，接着做预测的，最后计算我们定义的指标。
6. 网络一出错要调试的时候，只能很蠢地输出每一个Tensor or Numpy的shape，然后对手动计算正确与否，调试效率是很低的，但是这个没办法，只能这么调。（大概线代学得好会调得比较快吧）
7. python全局变量相较于C实在是不够友好，不论是修改、引用还是定义都要加global关键词。
8. 项目部署到服务器上，项目的根路径就变成`C：//User//Admin`了，所以里面读取文件部分我用的是绝对路径。
9. 数据还有配置文件.xml之类的，不应该上传到服务器上，这个我的锅......当时对.gitnore那玩意不了解，造成其他人同步项目的时候会造成不必要的麻烦。
10. 用CNN里面的One-Shot 模型，晚上找了份代码只计算了loss，再加上后面没有继续跟进下来，就荒废了，那块当时学习还花了不少时间。
11. 怀疑数据的准确性的时候，自己做测试画的两张图，量程不一样造成的图像不一样没注意到，误判数据有误，浪费了很多精力。
12. SVM实际检测效果还算正常， 但是跑实验写指标数据的时候出现全0的情况，这个错误不应该有，但是还没调。

